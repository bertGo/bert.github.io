---
layout: post
title : TCP三次握手
subtitle : What How Why
author : Bert
header-img: img/post-bg-2015.jpg
catalog : true
date : 2018-08-18 12:00:00
tags :
 - TCP
 - 网络传输协议
 - 
---

### TCP协议的作用

- 数据包基于IP协议进行传输，但并不保证数据的完整。如果路由器丢包，以及如何重新发送这个包，就需要靠TCP协议。

  *超时重新发送以及快速重新发送，提高了数据的稳定完整，但同时也提高了数据包的体积。*

### TCP三次握手

- What?（三次握手是什么）

  1. 客户端发送一个SYN(同步序列编号，TCP建立连接时的握手信号)
  2. 服务器回复一个ACK(确认字符,表示发来的数据已确认接收无误)和SYN(握手)
  3. 客户端回复一个ACK,表示收到信息，可以建立连接。
     - seq是我们常说的序号，这个序号是通过一个算法得到一个初始序号(ISN)加１
       就是告诉接收方，我发送的数据是从seq开始的。
     - ACK是确认值()
     - ack是确认编号
       就是告诉接收方，我希望下次收到对端发过来的seq序号

  ![](https://upload-images.jianshu.io/upload_images/10185166-eef6b8478a07f682.png?imageMogr2/auto-orient/strip|imageView2/2/w/529/format/webp)

  用打电话的生活实例:

  ```php
  我：华南，你是不是在班里呀？
  华南：你怎么知道我在班里呀？
  我：华南，你除了在班里，你还能在哪？
  ```

- How？(握手的目的是什么？)

  确认双方都可以接收数据并可以发送数据(我说的话，你能听到，你说的话，我也能听到),保证数据不丢包。

- Why？(为什么是三次握手，而不是两次握手或者是四次握手？)

  - title : 二次握手
    我：华南，你是不是在班里呀？
    华南：你怎么知道我在班里呀？
    
    > 无法确认双方都可以接收到数据
    
  - 四次握手:
  
    > 在三次都可以完成的情况下，４次甚至多次会造成资源浪费
  
- 同时在TCP协议中，一个请求长时间未得到回应，服务端就知道这个请求丢失了，就会重新发送请求，这是请求超时重传规则

